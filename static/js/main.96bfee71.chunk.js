(this["webpackJsonpflux-controll-front"]=this["webpackJsonpflux-controll-front"]||[]).push([[0],{296:function(e,t,a){e.exports=a(579)},305:function(e,t,a){},307:function(e,t,a){},406:function(e,t,a){},407:function(e,t,a){},451:function(e,t,a){},452:function(e,t,a){},453:function(e,t,a){},454:function(e,t,a){},483:function(e,t){},486:function(e,t,a){},487:function(e,t,a){},578:function(e,t,a){},579:function(e,t,a){"use strict";a.r(t);var n={};a.r(n),a.d(n,"setCompanies",(function(){return q})),a.d(n,"selectVehicle",(function(){return B})),a.d(n,"selectCompany",(function(){return K}));var r=a(0),c=a.n(r),o=a(30),i=a.n(o),u=a(51),l=(a(305),a(306),a(27)),s=a(123),m={selectedVehicle:null,selectedCompany:null,source:[]};var p=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_COMPANIES":return Object(s.a)({},e,{source:t.source});case"SELECT_VEHICLE":return Object(s.a)({},e,{selectedVehicle:t.selectedVehicle});case"SELECT_COMPANY":return Object(s.a)({},e,{selectedCompany:t.selectedCompany});default:return e}},d=Object(l.b)({companies:p}),f=Object(l.c)(d),v=a(50),h=a(52),E=a(10),b=(a(307),a(589)),g=a(590),y=a(120),O=a(6),x=a.n(O),j=a(8),w=a(47),k=a(48),N="https://flux-control-node-api.herokuapp.com",C=new(function(){function e(){Object(w.a)(this,e);var t=JSON.parse(localStorage.getItem("session"));this.bearer=(null===t||void 0===t?void 0:t.token)||""}return Object(k.a)(e,[{key:"login",value:function(){var e=Object(j.a)(x.a.mark((function e(){var t,a,n,r,c,o,i,u,l,s=arguments;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=s.length>0&&void 0!==s[0]?s[0]:{},a=s.length>1?s[1]:void 0,n=t.login,r=t.password,c={email:n,password:r},o="".concat(N,"/api/users/login"),i=JSON.stringify(c),e.next=8,fetch(o,{method:"POST",headers:{"Content-Type":"application/json"},body:i});case 8:if(200!==(u=e.sent).status){e.next=16;break}return e.next=12,u.json();case 12:l=e.sent,this.bearer=l.token,delete l.message,localStorage.setItem("session",JSON.stringify(l));case 16:a(this.isAuthenticated());case 17:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"logout",value:function(){this.bearer=null,localStorage.setItem("session",null)}},{key:"isAuthenticated",value:function(){return!!this.bearer}}]),e}());var S=function(e){var t=e.history,a=Object(r.useState)("login"),n=Object(E.a)(a,2),o=n[0],i=n[1],u=Object(r.useState)("password"),l=Object(E.a)(u,2),s=l[0],m=l[1],p=Object(r.useState)([]),d=Object(E.a)(p,2),f=d[0],v=d[1];return Object(r.useEffect)((function(){C.isAuthenticated()&&t.push("/")})),c.a.createElement("main",{id:"login"},c.a.createElement("div",{className:"login"},c.a.createElement("div",{className:"extra"},c.a.createElement("h2",null,"Transpar\xeancia"),c.a.createElement("p",null,"Aqui voc\xea pode ver a situa\xe7\xe3o de todas as empresas de \xf4nibus que utilizam do terminal rodovi\xe1rio de ",c.a.createElement("b",null,"S\xe3o Jos\xe9 do Rio Preto"),"."),c.a.createElement("a",{href:"#mais-sobre"},"Vamos l\xe1")),c.a.createElement("section",{className:"login-box"},c.a.createElement("div",{className:"login-title"},c.a.createElement("h1",null,"Login")),c.a.createElement("div",{className:"login-field"},c.a.createElement("label",{htmlFor:"email"},"Email"),c.a.createElement(b.a,{id:"email",type:"text",placeholder:"email@example.com",onChange:function(e){return i(e)}})),c.a.createElement("div",{className:"login-field"},c.a.createElement("label",{htmlFor:"password"},"Senha"),c.a.createElement(b.a,{id:"password",type:"password",onChange:function(e){return m(e)}})),c.a.createElement("div",{className:"messages v-box"},f.map((function(e){return c.a.createElement(g.a,{type:"error",description:e})}))),c.a.createElement(y.a,{className:"login-submit",appearance:"primary",onClick:function(e){var a=e.target;a.disabled=!0,v([]),C.login({login:o,password:s},(function(e){if(a.disabled=!1,e)t.push("/");else{var n=[];n.push("Usu\xe1rio e/ou senha incorreto(s)"),v(n)}}))}},"Entrar"))))},T=a(115),_=(a(406),a(407),a(585)),G=a(275),P=a(294),A=a(121),I=a(588);var V=function(e){var t=e.history,a=e.current,n=Object(r.useState)(null),o=Object(E.a)(n,2),i=o[0],u=o[1];return Object(r.useEffect)((function(){var e=JSON.parse(localStorage.getItem("session")),t=e.user.name.split(" "),a=Object(E.a)(t,2),n=a[0],r=a[1];e.user.name="".concat(n," ").concat(r),u(e.user)}),[]),c.a.createElement("div",{id:"menu"},c.a.createElement(_.a,{activeKey:a},c.a.createElement(_.a.Header,null,c.a.createElement("div",null,c.a.createElement("div",{id:"user-actions",className:"h-box"},c.a.createElement(v.b,{to:"/settings"},c.a.createElement(G.a,{placement:"auto",trigger:"hover",speaker:c.a.createElement(P.a,null,"Configura\xe7\xf5es")},c.a.createElement(A.a,{icon:"gear-circle"}))),c.a.createElement(v.b,{to:"/login",onClick:function(){return C.logout()}},c.a.createElement(G.a,{placement:"auto",trigger:"hover",speaker:c.a.createElement(P.a,null,"Sair")},c.a.createElement(A.a,{icon:"sign-out"})))),c.a.createElement("div",{id:"user-info",className:"h-box"},c.a.createElement("div",{className:"img",style:{backgroundImage:"url('https:api.adorable.io/avatars/100/abott@adorable.png')"}}),c.a.createElement("div",{className:"name v-box"},c.a.createElement("b",{id:"user-role"},{admin:"Administrador",manager:"Gerente",operator:"Operador"}[null===i||void 0===i?void 0:i.role]),c.a.createElement("span",{className:"user-name"},null===i||void 0===i?void 0:i.name))))),c.a.createElement(_.a.Body,null,c.a.createElement(I.a,null,c.a.createElement(I.a.Item,{eventKey:"register",icon:c.a.createElement(A.a,{icon:"exchange"}),onClick:function(){return t.push("/register")}},"Registrar"),c.a.createElement(I.a.Item,{eventKey:"timeline",icon:c.a.createElement(A.a,{icon:"realtime"}),onClick:function(){return t.push("/timeline")}},"Linha do tempo")))))};a(451);var F=function(){return c.a.createElement("section",{id:"settings"},"Tela de Configura\xe7\xf5es")},L=(a(452),a(592)),D=a(593),H=a(586),J=a(591),M=function(){var e=Object(j.a)(x.a.mark((function e(){var t,a,n,r,c,o=arguments;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=o.length>0&&void 0!==o[0]?o[0]:{api:"",body:{},method:"POST"},a="".concat(N,"/").concat(t.api),n=JSON.stringify(t.body),r={method:t.method,headers:{"Content-Type":"application/json",Authorization:"bearer "+C.bearer}},n&&(r.body=t.body),e.next=7,fetch(a,r);case 7:return c=e.sent,e.next=10,c.json();case 10:return e.abrupt("return",e.sent);case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),R=new(function(){function e(){Object(w.a)(this,e),this.uri="api/companies/"}return Object(k.a)(e,[{key:"get",value:function(){var e=Object(j.a)(x.a.mark((function e(t){var a;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,M({method:"GET",api:this.uri+"get/"+t});case 3:return a=e.sent,e.abrupt("return",null===a||void 0===a?void 0:a.company);case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",null);case 10:case"end":return e.stop()}}),e,this,[[0,7]])})));return function(t){return e.apply(this,arguments)}}()},{key:"load",value:function(){var e=Object(j.a)(x.a.mark((function e(){var t;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,M({method:"GET",api:this.uri});case 3:return t=e.sent,e.abrupt("return",t.items||[]);case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",[]);case 10:case"end":return e.stop()}}),e,this,[[0,7]])})));return function(){return e.apply(this,arguments)}}()},{key:"getFleet",value:function(){var e=Object(j.a)(x.a.mark((function e(t){var a;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,M({method:"GET",api:this.uri+"fleet/"+t});case 3:return a=e.sent,e.abrupt("return",a.fleet||[]);case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",[]);case 10:case"end":return e.stop()}}),e,this,[[0,7]])})));return function(t){return e.apply(this,arguments)}}()},{key:"update",value:function(){var e=Object(j.a)(x.a.mark((function e(t){var a;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,M({method:"PATCH",api:this.uri+"change",body:t});case 3:return a=e.sent,e.abrupt("return","company_updated"===a.message);case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",null);case 10:case"end":return e.stop()}}),e,this,[[0,7]])})));return function(t){return e.apply(this,arguments)}}()},{key:"remove",value:function(){var e=Object(j.a)(x.a.mark((function e(t){var a;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,M({method:"DELETE",api:this.uri+"remove/"+t});case 3:return a=e.sent,e.abrupt("return","company_deleted"===a.message);case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",null);case 10:case"end":return e.stop()}}),e,this,[[0,7]])})));return function(t){return e.apply(this,arguments)}}()}]),e}());function q(e){return{type:"SET_COMPANIES",source:e}}function B(e){return{type:"SELECT_VEHICLE",selectedVehicle:e}}function K(e){return{type:"SELECT_COMPANY",selectedCompany:e}}a(453),a(454);var U=a(277),z=a.n(U).a.connect(N,{autoConnect:!1}),Y=(a(486),a(42)),Q=a.n(Y),W=new(function(){function e(){Object(w.a)(this,e),this.uri="api/vehicles/"}return Object(k.a)(e,[{key:"arrival",value:function(){var e=Object(j.a)(x.a.mark((function e(t){var a;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,M({method:"POST",api:this.uri+"arrival/"+t});case 3:return a=e.sent,e.abrupt("return",a.moment);case 7:return e.prev=7,e.t0=e.catch(0),console.error(e.t0),e.abrupt("return",null);case 11:case"end":return e.stop()}}),e,this,[[0,7]])})));return function(t){return e.apply(this,arguments)}}()},{key:"departure",value:function(){var e=Object(j.a)(x.a.mark((function e(t){var a;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,M({method:"PUT",api:this.uri+"departure/"+t});case 3:return a=e.sent,e.abrupt("return",a.moment);case 7:return e.prev=7,e.t0=e.catch(0),console.error(e.t0),e.abrupt("return",null);case 11:case"end":return e.stop()}}),e,this,[[0,7]])})));return function(t){return e.apply(this,arguments)}}()},{key:"search",value:function(){var e=Object(j.a)(x.a.mark((function e(t){var a;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,M({method:"GET",api:this.uri+"search?query="+t});case 3:return a=e.sent,e.abrupt("return",a.items||[]);case 7:return e.prev=7,e.t0=e.catch(0),console.error(e.t0),e.abrupt("return",[]);case 11:case"end":return e.stop()}}),e,this,[[0,7]])})));return function(t){return e.apply(this,arguments)}}()},{key:"garage",value:function(){var e=Object(j.a)(x.a.mark((function e(){var t;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,M({method:"GET",api:this.uri+"garage"});case 3:return t=e.sent,e.abrupt("return",t.items||[]);case 7:return e.prev=7,e.t0=e.catch(0),console.error(e.t0),e.abrupt("return",[]);case 11:case"end":return e.stop()}}),e,this,[[0,7]])})));return function(){return e.apply(this,arguments)}}()},{key:"get",value:function(){var e=Object(j.a)(x.a.mark((function e(t){var a;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,M({method:"GET",api:this.uri+"get/"+t});case 3:return a=e.sent,e.abrupt("return",null===a||void 0===a?void 0:a.vehicle);case 7:return e.prev=7,e.t0=e.catch(0),console.error(e.t0),e.abrupt("return",null);case 11:case"end":return e.stop()}}),e,this,[[0,7]])})));return function(t){return e.apply(this,arguments)}}()},{key:"load",value:function(){var e=Object(j.a)(x.a.mark((function e(){var t;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,M({method:"GET",api:this.uri});case 3:return t=e.sent,e.abrupt("return",t.items||[]);case 7:return e.prev=7,e.t0=e.catch(0),console.error(e.t0),e.abrupt("return",[]);case 11:case"end":return e.stop()}}),e,this,[[0,7]])})));return function(){return e.apply(this,arguments)}}()},{key:"update",value:function(){var e=Object(j.a)(x.a.mark((function e(t){var a;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,M({method:"PATCH",api:this.uri+"change",body:t});case 3:return a=e.sent,e.abrupt("return","vehicle_updated"===a.message);case 7:return e.prev=7,e.t0=e.catch(0),console.error(e.t0),e.abrupt("return",null);case 11:case"end":return e.stop()}}),e,this,[[0,7]])})));return function(t){return e.apply(this,arguments)}}()},{key:"remove",value:function(){var e=Object(j.a)(x.a.mark((function e(t){var a;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,M({method:"DELETE",api:this.uri+"remove/"+t});case 3:return a=e.sent,e.abrupt("return","vehicle_deleted"===a.message);case 7:return e.prev=7,e.t0=e.catch(0),console.error(e.t0),e.abrupt("return",null);case 11:case"end":return e.stop()}}),e,this,[[0,7]])})));return function(t){return e.apply(this,arguments)}}()}]),e}());var X=function(e){var t=e.start,a=e.max,n=e.onEnd,o=Object(r.useState)(s(t)),i=Object(E.a)(o,2),u=i[0],l=i[1];function s(e){return Q.a.duration(Q()(new Date).diff(Q()(e)))}return Object(r.useEffect)((function(){var e;return u>a?(clearTimeout(e),n()):e=setTimeout((function(){l(s(t))}),1e3),function(){clearTimeout(e)}}),[u]),c.a.createElement("div",{className:"timer"},Q()(u.asMilliseconds()).format("mm:ss"))};var Z=Object(u.b)((function(e){return{companies:e.companies}}),(function(e){return Object(l.a)(n,e)}))((function(e){var t,a,n=e.companyName,o=e.vehicle,i=e.companies,u=e.selectVehicle,l=Object(r.useState)(!1),s=Object(E.a)(l,2),m=s[0],p=s[1],d=function(){var e=Object(j.a)(x.a.mark((function e(t){var a;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return p(!0),e.next=3,W.arrival(t.id);case 3:(a=e.sent)&&(t.last_record={moment:a,onGarage:!0},z.emit("vehicle-arrival",t)),p(!1);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),f=function(){var e=Object(j.a)(x.a.mark((function e(t){var a;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return p(!0),e.next=3,W.departure(t.id);case 3:(a=e.sent)&&(t.last_record={moment:a,onGarage:!1},z.emit("vehicle-departure",t)),p(!1);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{className:"vehicle-card h-box\n          ".concat((null===(t=i.selectedVehicle)||void 0===t?void 0:t.id)===o.id?"selected":"","\n          ").concat(m?"pulse":""),onClick:function(e){var t;return u((null===(t=i.selectedVehicle)||void 0===t?void 0:t.id)===o.id?null:o)}},o.last_record.onGarage?c.a.createElement(X,{start:o.last_record.moment,max:Q.a.duration(15,"minutes"),onEnd:function(){f(o)}}):null,c.a.createElement("div",{className:"vehicle-info v-box"},c.a.createElement("b",{className:"license-plate"},o.license_plate),c.a.createElement("span",{className:"company-and-number"},n," ",c.a.createElement("b",{className:"number"},"#",o.number))),m?c.a.createElement("div",{className:"loader"},c.a.createElement(J.a,null)):c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{className:"last-record h-box"},o.last_record?c.a.createElement(A.a,{className:"icon ".concat(o.last_record.onGarage?"arrival":"departure"),icon:"".concat(o.last_record.onGarage?"caret-right":"caret-left")}):c.a.createElement("small",{className:"no-record"},"sem registro"),o.last_record?c.a.createElement("span",{className:"moment"},c.a.createElement("small",{className:"date"},Q()(o.last_record.moment).format("DD/MM")),c.a.createElement("br",null),Q()(o.last_record.moment).format("HH:mm")):null),c.a.createElement(y.a,{className:"action",appearance:"primary",onClick:function(){var e=Object(j.a)(x.a.mark((function e(t){var a;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(null===(a=o.last_record)||void 0===a?void 0:a.onGarage)){e.next=5;break}return e.next=3,f(o);case 3:e.next=7;break;case 5:return e.next=7,d(o);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},(null===(a=o.last_record)||void 0===a?void 0:a.onGarage)?"Sa\xedda":"Entrada"))))}));var $=function(e){var t=e.company,a=Object(r.useState)(!1),n=Object(E.a)(a,2),o=n[0],i=n[1],u=Object(r.useState)(t.fleet.slice(0,3)),l=Object(E.a)(u,2),s=l[0],m=l[1],p=function(e){m(e?t.fleet:t.fleet.slice(0,3)),i(e)};return Object(r.useEffect)((function(){return z.open(),z.on("vehicle-action",(function(e){t.fleet=t.fleet.map((function(t){return t.id===e.id?e:t})),p(o)})),function(){z.close()}}),[]),c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{className:"vehicle-card-list h-box"},s.map((function(e){return c.a.createElement(Z,{key:e.id,companyName:t.name,vehicle:e})}))),t.fleet.length>3?c.a.createElement("a",{className:"show-more",href:"#".concat(t.name.toLowerCase(),"-exibir-").concat(o?"mais":"menos"),onClick:function(e){p(!o)}},"exibir ".concat(o?"menos":"mais")):null)};var ee=function(e){var t=e.companies;return c.a.createElement(c.a.Fragment,null,t.map((function(e){return c.a.createElement("div",{key:e.id},e.fleet.length?c.a.createElement("div",{className:"company v-box"},c.a.createElement("div",{className:"company-info h-box"},c.a.createElement("div",{className:"company-thumbnail",style:{borderColor:e.color,backgroundImage:"url('".concat(e.thumbnail||"images/no-image.jpg","')")}}),c.a.createElement("h4",{className:"company-name"},e.name)),c.a.createElement($,{company:e})):null)})))};var te=Object(u.b)((function(e){return{companies:e.companies}}),(function(e){return Object(l.a)(n,e)}))((function(e){var t=e.companies,a=e.setCompanies,n=Object(r.useState)(!1),o=Object(E.a)(n,2),i=o[0],u=o[1],l=Object(r.useState)(0),s=Object(E.a)(l,2),m=s[0],p=s[1];function d(){return(d=Object(j.a)(x.a.mark((function e(){var t,n;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u(!0),e.next=3,R.load();case 3:t=e.sent,n=t.map((function(e){return R.getFleet(e.id)})),Promise.all(n).then((function(e){for(var n in t)t[n].fleet=e[n];var r=0,c=!0,o=!1,i=void 0;try{for(var l,s=t[Symbol.iterator]();!(c=(l=s.next()).done);c=!0){r+=l.value.fleet.length}}catch(m){o=!0,i=m}finally{try{c||null==s.return||s.return()}finally{if(o)throw i}}p(r),a(t),u(!1)}));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(r.useEffect)((function(){!function(){d.apply(this,arguments)}()}),[]),c.a.createElement("section",{id:"register"},c.a.createElement("div",{className:"container"},c.a.createElement("div",{className:"vehicle-search h-box"},c.a.createElement("div",{className:"pagination"},c.a.createElement("span",{className:"results"},c.a.createElement("b",null,"Encontrados:"),c.a.createElement("span",null,m))),c.a.createElement("div",{className:"search-box h-box"},c.a.createElement(G.a,{trigger:"click",placement:"auto",speaker:c.a.createElement(L.a,{className:"toggle-on-garage"},c.a.createElement(D.a,{onChange:function(e){return console.log(e)}}),c.a.createElement("span",null,"Apenas na garagem"))},c.a.createElement(y.a,{className:"filter",appearance:"default"},c.a.createElement(A.a,{icon:"filter"})," \xa0 Filtrar")),c.a.createElement(H.a,{inside:!0},c.a.createElement(b.a,{placeholder:"Procurar"}),c.a.createElement(H.a.Button,null,c.a.createElement(A.a,{icon:"search"}))))),c.a.createElement("hr",null),i?c.a.createElement("center",null,c.a.createElement(J.a,null)):c.a.createElement(ee,{companies:t.source})))})),ae=(a(487),a(587)),ne=a(278),re=new(function(){function e(){Object(w.a)(this,e),this.uri="api/flow-records/"}return Object(k.a)(e,[{key:"get",value:function(){var e=Object(j.a)(x.a.mark((function e(t){var a;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,M({method:"GET",api:this.uri+"get/"+t});case 3:return a=e.sent,e.abrupt("return",null===a||void 0===a?void 0:a.flowRecord);case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",null);case 10:case"end":return e.stop()}}),e,this,[[0,7]])})));return function(t){return e.apply(this,arguments)}}()},{key:"getHistoric",value:function(){var e=Object(j.a)(x.a.mark((function e(t){var a;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,M({method:"GET",api:this.uri+"historic/"+t});case 3:return a=e.sent,e.abrupt("return",a.items||[]);case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",[]);case 10:case"end":return e.stop()}}),e,this,[[0,7]])})));return function(t){return e.apply(this,arguments)}}()},{key:"load",value:function(){var e=Object(j.a)(x.a.mark((function e(){var t;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,M({method:"GET",api:this.uri});case 3:return t=e.sent,e.abrupt("return",t.items||[]);case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",[]);case 10:case"end":return e.stop()}}),e,this,[[0,7]])})));return function(){return e.apply(this,arguments)}}()},{key:"remove",value:function(){var e=Object(j.a)(x.a.mark((function e(t){var a;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,M({method:"DELETE",api:this.uri+"remove/"+t});case 3:return a=e.sent,e.abrupt("return","company_deleted"===a.message);case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",null);case 10:case"end":return e.stop()}}),e,this,[[0,7]])})));return function(t){return e.apply(this,arguments)}}()}]),e}());var ce=Object(u.b)((function(e){return{companies:e.companies}}),(function(e){return Object(l.a)(n,e)}))((function(e){var t=e.companies,a=e.selectCompany,n=Object(r.useState)(!1),o=Object(E.a)(n,2),i=(o[0],o[1]),u=Object(r.useState)(null),l=Object(E.a)(u,2),s=l[0],m=l[1];return Object(r.useEffect)((function(){m(null),t.selectedCompany||a(t.source[0]),function(){if(i(!0),t.selectedCompany){var e=t.selectedCompany.fleet.map((function(e){return re.getHistoric(e.id)})),a=[[{type:"string",id:"Vehicle"},{type:"date",id:"Start"},{type:"date",id:"End"}]];Promise.all(e).then((function(e){e.forEach((function(e,n){e=e.reverse().slice(0,6);var r=!0,c=!1,o=void 0;try{for(var i,u=e[Symbol.iterator]();!(r=(i=u.next()).done);r=!0){var l,s=i.value;a.push([t.selectedCompany.fleet[n].license_plate,new Date(s.arrival.moment),(null===(l=s.departure)||void 0===l?void 0:l.moment)?new Date(s.departure.moment):new Date])}}catch(m){c=!0,o=m}finally{try{r||null==u.return||u.return()}finally{if(c)throw o}}})),m(a),i(!1)}))}}()}),[t.selectedCompany]),c.a.createElement("section",{id:"timeline",className:"h-box"},c.a.createElement("div",{className:"companies"},t.source.map((function(e){var n;return e.fleet.length?c.a.createElement("div",{key:e.id,className:"".concat((null===(n=t.selectedCompany)||void 0===n?void 0:n.id)===e.id?"selected":""," company v-box"),onClick:function(){return a(e)}},c.a.createElement("div",{className:"company-info h-box"},c.a.createElement("div",{className:"company-thumbnail",style:{borderColor:e.color,backgroundImage:"url('".concat(e.thumbnail||"/images/no-image.jpg","')")}}),c.a.createElement("h4",{className:"company-name"},e.name),c.a.createElement("span",{className:"company-fleet h-box"},c.a.createElement(A.a,{icon:"car"}),c.a.createElement("b",null,e.fleet.length)))):null}))),c.a.createElement("div",{className:"container"},c.a.createElement("div",{className:"vehicle-search h-box"},c.a.createElement(ae.a,null),c.a.createElement("div",{className:"search-box h-box"},c.a.createElement(G.a,{trigger:"click",placement:"auto",speaker:c.a.createElement(L.a,{className:"toggle-on-garage"},"FILTROS")},c.a.createElement(y.a,{className:"filter",appearance:"default"},c.a.createElement(A.a,{icon:"filter"})," \xa0 Filtrar")),c.a.createElement(H.a,{inside:!0},c.a.createElement(b.a,{placeholder:"Procurar"}),c.a.createElement(H.a.Button,null,c.a.createElement(A.a,{icon:"search"}))))),c.a.createElement("hr",null),c.a.createElement("div",{className:"container-body"},s?c.a.createElement(ne.a,{width:"100%",height:300,chartType:"Timeline",loader:c.a.createElement("center",null,c.a.createElement(J.a,null)),data:s,options:{showRowNumber:!1}}):c.a.createElement("center",null,c.a.createElement(J.a,null)))))}));a(578);var oe=function(e){var t=e.search;return c.a.createElement("section",{id:"not-found"},c.a.createElement("div",{className:"content v-box"},c.a.createElement("h3",null,"Ops! Nada por aqui"),c.a.createElement("p",null,"N\xe3o encontramos nada que corresponda \xe0 ",c.a.createElement("b",null,'"/',t,'"')," para voc\xea."),c.a.createElement("br",null),c.a.createElement("p",null,"Poss\xedveis causas:"),c.a.createElement("ul",null,c.a.createElement("li",null,"Rota inexistente"),c.a.createElement("li",null,"O servi\xe7o encontra-se indispon\xedvel"),c.a.createElement("li",null,"Voc\xea n\xe3o tem permiss\xe3o para acessar o recurso")),c.a.createElement("small",null,c.a.createElement(v.b,{to:"/"},"Voltar para o in\xedcio"))))};var ie=function(e){var t=e.history,a=e.match,n=(Object(T.a)(e,["history","match"]),Object(r.useState)("register")),o=Object(E.a)(n,2),i=o[0],u=o[1];return Object(r.useEffect)((function(){a.params.view?u(a.params.view):t.push("/register")}),[t,a.params.view]),c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{id:"geral",className:"h-box"},c.a.createElement(V,{history:t,current:i}),c.a.createElement("main",{id:"screen"},{settings:c.a.createElement(F,null),register:c.a.createElement(te,null),timeline:c.a.createElement(ce,null)}[i]||c.a.createElement(oe,{search:i}))))};var ue=function(e){var t=e.component,a=Object(T.a)(e,["component"]);return c.a.createElement(h.b,Object.assign({},a,{render:function(e){return C.isAuthenticated()?c.a.createElement(t,e):c.a.createElement(h.a,{to:{pathname:"/login",state:{from:e.location}}})}}))};var le=function(){return c.a.createElement(v.a,null,c.a.createElement(h.d,null,c.a.createElement(h.b,{exact:!0,path:"/login",component:S}),c.a.createElement(ue,{exact:!0,path:"/:view?",component:ie}),c.a.createElement(h.b,{path:"*",component:function(){return"404 NOT FOUND"}})))};i.a.render(c.a.createElement((function(){return c.a.createElement(u.a,{store:f},c.a.createElement("div",{className:"App"},c.a.createElement(le,null)))}),null),document.getElementById("root"))}},[[296,1,2]]]);
//# sourceMappingURL=main.96bfee71.chunk.js.map